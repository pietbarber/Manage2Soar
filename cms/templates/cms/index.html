{% extends "base.html" %}
{% block content %}
  <div style="display:flex;align-items:center;justify-content:space-between;">
    <div>
      <h1 style="margin:0">Resources</h1>
      <p style="margin:0.25rem 0 0 0">Browse top-level resource directories and files available to members.</p>
    </div>
    {% if user.is_authenticated %}
      {% if user.webmaster or perms.cms.change_page %}
        <div>
          <a class="btn btn-sm btn-primary" href="{% url 'admin:cms_page_changelist' %}">Manage content</a>
        </div>
      {% endif %}
    {% endif %}
  </div>
  <table class="table table-sm table-striped">
    <thead>
      <tr><th>Directory</th><th>Resources</th><th>Visibility</th></tr>
    </thead>
    <tbody>
      {% if pages %}
        {% for item in pages %}
        <tr>
          <td>
            {% if item.can_view %}
              <a href="{{ item.page.get_absolute_url }}">{{ item.page.title }}</a>
            {% else %}
              {{ item.page.title }}
            {% endif %}
          </td>
          <td>{{ item.doc_count }}</td>
          <td>{{ item.is_public|yesno:"Public,Restricted" }}</td>
        </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="3">
            <div class="alert alert-info mb-0">No resources or folders to display yet. Check back later or visit the <a href="/admin/">admin</a> to add content.</div>
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>
{% endblock %}
