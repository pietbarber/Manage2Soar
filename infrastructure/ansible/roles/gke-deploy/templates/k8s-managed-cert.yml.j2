# Google-managed SSL Certificate
# Generated by Ansible - DO NOT EDIT DIRECTLY
#
# This creates a Google-managed SSL certificate that is automatically
# provisioned and renewed by Google. No cert-manager or Let's Encrypt needed.
#
# Certificate provisioning requires:
# 1. DNS records pointing to the Ingress IP
# 2. Up to 15 minutes for certificate provisioning
#
# Check certificate status:
#   kubectl describe managedcertificate {{ gke_app_name }}-cert -n {{ gke_namespace }}
---
apiVersion: networking.gke.io/v1
kind: ManagedCertificate
metadata:
  name: {{ gke_app_name }}-cert
  namespace: {{ gke_namespace }}
  labels:
    app: {{ gke_app_name }}
    managed-by: ansible
spec:
  domains:
{% if gke_multi_tenant | bool %}
{#- Multi-tenant: collect domains for current tenant only -#}
{% for tenant in gke_tenants %}
{% if tenant.prefix == gke_club_prefix %}
{% set tenant_domains = tenant.domains | default([tenant.domain] if tenant.domain is defined else []) %}
{% for domain in tenant_domains %}
    - {{ domain }}
{% endfor %}
{% endif %}
{% endfor %}
{% else %}
{#- Single-tenant: use configured domains -#}
{% set domains = gke_domains | default([gke_domain] if gke_domain is defined else [gke_base_domain]) %}
{% for domain in domains %}
    - {{ domain }}
{% endfor %}
{% endif %}
